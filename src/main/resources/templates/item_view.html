<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>View Item</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>

<body>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
        <script src="https://kit.fontawesome.com/03e96c11a3.js" crossorigin="anonymous"></script>

        <style>
            .custom-tooltip {
                --bs-tooltip-bg: var(--bd-violet-bg);
                --bs-tooltip-color: var(--bs-white);
              }
        </style>
    <script th:inline="javascript"> 
        

        function searchItem(){
            const query = document.getElementById("query").value 
        
            let url = "http://localhost:8080/home/search?query="

            if(query.length > 0){
                url += query;
            }
            
            window.location.href = url  
        }

        function logOut(){
            let url = "http://localhost:8080/customer/logout" 
            let body = ""

            fetch(url, {
                method: 'POST',
                body: body,
                headers: {
                    'Content-Type': 'application/json'
                },
            }).then((res)=>{
                window.location.href = res.url 
            })
            .catch((err)=>{
                console.log(err) 
            })
        }

        function logIn(){
            let url = 'http://localhost:8080/customer/login'
            window.location.href = url 
        }

        function addToCart(){
            const customerId = document.getElementById("loginID").textContent

            const itemCode = document.getElementById("id").textContent
            const itemName = document.getElementById("name").textContent

            const price = document.getElementById("price").textContent
            const quantity = document.getElementById("quantity").value 

            let url = "http://localhost:8080/cart/additem" 
            let body = JSON.stringify({
                itemCode,
                itemName,
                price,
                quantity
            })

            fetch(url, {
                method: 'POST',
                body: body,
                headers: {
                    'Content-Type': 'application/json'
                },
            }).then((res)=>{
                alert('Added')
                console.log(res) 
            })
            .catch((err)=>{
                console.log(err) 
            })
        }
    </script>
    <div class="container-fluid">
        <nav class="navbar navbar-expand-lg bg-body-tertiary">
            <div class="container-fluid">
                <a class="navbar-brand" href="#">Item Page</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-item">
                            <a class="nav-link active" aria-current="page" href = "http://localhost:8080/home">
                                Home
                            </a>
                        </li>
                        
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                                aria-expanded="false"
                                th:if="${loginID}!= ''" th:text="'Welcome, ' + ${customer.name.firstName} + ' ' + ${customer.name.lastName}">
                                
                            </a>
                            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                                aria-expanded="false"
                                th:if="${loginID}== ''" th:text="'Welcome, Log In'">
                                
                            </a>
                            <ul class="dropdown-menu">
                                
                                <li><a class="dropdown-item" th:if="${loginID}!= ''" href="http://localhost:8080/customer/home">My Home</a></li>
                                <li><a class="dropdown-item" th:if="${loginID}!= ''" href="#">My Orders</a></li>
                                <li><a class="dropdown-item" th:if="${loginID}!= ''" href="http://localhost:8080/customer/mycart">My Cart</a></li>
                                <li>
                                    <hr th:if="${loginID}!= ''" class="dropdown-divider">
                                </li>
                                <li><a class="dropdown-item" th:if="${loginID}!= ''" onclick="logOut()">Logout</a></li>
                                <li><a class="dropdown-item" th:if="${loginID} == ''" onclick="logIn()">Log In</a></li>
                                
                            </ul>
                        </li>
                        
                    </ul>
                    <div class="d-flex" role="">
                        
                        <input class="form-control me-2" type="text" placeholder="Search" aria-label="Search" id = "query"
                        >
                        <button class="btn btn-outline-success" onclick="searchItem()">Search</button>
                          </div>
                </div>
            </div>
        </nav>
        <div class="row">
            <div class="col"></div>
            <div class="col text-center">
                <p class="display-6"></p>
            </div>
            <div class="col"></div>
        </div>
        <div class="row">
            <div class="col"></div>
            <div class="col text-center">
                
            </div>
            <div class="col"></div>
        </div>
        <div class="row">
            <div class="col-2"></div>
            <div class="col-4">
                <p th:text = "${item.id}" hidden id = "id"></p>
                <p th:text = "${loginID}" hidden id = "loginID"></p>
            </div>
            <div class="col-4"></div>
        </div>
        <div id="items" class="row">
            <div class="col-2"></div>

            <div class="col-8">
                <h4 th:text="${item.itemName}" class="display-6 text-center" id = "name">JBL HEADPHONES</h4>
                <p>Type: <mark>ELECTRONIC</mark></p>
                <p th:text="${item.description}">
                    Lorem ipsum dolor sit amet consectetur adipisicing elit. Libero dignissimos doloribus doloremque, rerum excepturi sunt vero quo aut quia autem. Corrupti ipsa, iusto possimus quae doloremque reprehenderit perferendis itaque magnam sit aspernatur error minus quam quibusdam obcaecati recusandae placeat dicta quidem voluptas libero inventore ex at. Esse voluptatum quibusdam libero!
                </p>
                <table class="table table-striped">
                    <tbody>
                        
                        <tr>
                            <th scope="row" >Price</th>
                            <td th:text="${item.price}" id = "price"><mark style="background-color:lightgreen;">7000.25</mark></td>
                        </tr>
                        <tr>
                            <th scope="row">Availablility</th>
                            <td th:if="${item.quantity} > 0" style="color: green;">Available</td>
                            <td th:if="${item.quantity} == 0" style="color:red;">Out of Stock</td>
                        </tr>
                        <tr>
                            <th scope="row">Sold By</th>
                            <td th:text="${item.sellerName}">eierf</td>
                        </tr>
                        
                    </tbody>
                </table>
            </div>
            <div class="col-2"></div>
        </div>
        <div class="row">
            <div class="col-4">

            </div>
            <div class="col-4">
                <div class="form-floating mb-3">
                    <select class="form-select" aria-label="select" id = "quantity">
                        <option th:each = "i : ${#numbers.sequence(1, item.quantity < 10 ? item.quantity : 10)}" th:text = "${i}"th:value="${i}" th:selected="${i} == 1"></option>
        
                    </select>
                    <label for="quantity">Quantity</label>
                </div>
            </div>
            <div class="col-4">
                <button class="btn btn-outline-success" th:disabled="${loginID} == ''" onclick="addToCart()"
                data-bs-toggle="tooltip"
                data-bs-placement="top"
                data-bs-title="Add To Cart">
                    <i class="fa-solid fa-shopping-cart"></i>
                </button>
                
            </div>
            </div>
            </div>
        </div>    
</body>

</html>